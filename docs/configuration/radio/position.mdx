---
id: position
title: "Настройки местоположения"
sidebar_label: "Местоположение"
description: "Настройки GPS‑позиции для устройства Meshtastic - интервалы обновления, broadcast и GPIO."
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import { Icon } from "@iconify/react";

Данные позиции из GPS приходят либо с радио, либо с привязанного телефона. Для Meshtastic это не обязательно, но для расчёта времени нужен хотя бы один узел в mesh с GPS, RTC или интернетом для NTP.

Настройки местоположения отправляются админ-сообщением с protobuf `Config.Position`. Доступные опции: GPS Mode, GPS Update Interval, Fixed Position, Smart Broadcast, Smart Broadcast Minimum Distance, Smart Broadcast Minimum Interval, Broadcast Interval, Position Flags и GPS RX/TX/EN Pins.

## Значения настроек Position {#position-config-values}

### GPS Mode {#gps-mode}

Определяет, включён ли GPS на узле, отключён или отсутствует.

Допустимые значения: `DISABLED`, `ENABLED` и `NOT_PRESENT`.

Обычно, в зависимости от устройства и его конфигурации, по умолчанию это `ENABLED` или `NOT_PRESENT`.

### GPS Update Interval {#gps-update-interval}

Как часто запрашивать GPS‑позицию (в секундах): 0 — по умолчанию раз в 2 минуты; очень большое значение (maxint) — только один раз при загрузке.

### Fixed Position {#fixed-position}

Допустимые значения: `true` или `false`

По умолчанию `false`

Если включено — узел считается стационарным. Устройство будет генерировать GPS‑обновления по обычному интервалу, но использовать последние сохранённые lat/lon/alt для узла. Эти lat/lon/alt можно получить от встроенного GPS или с GPS телефона.

### Smart Broadcast {#smart-broadcast}

Допустимые значения: `true` или `false`

По умолчанию `true`

Отправляет позицию чаще только при достаточном изменении местоположения, чтобы обновление было полезным.

Smart broadcast дополняет broadcast interval (не переопределяет его), вычисляет, как чаще обновлять сеть, когда вы в движении, и снижает частоту, когда стоите. Если используете эту функцию, лучше оставить broadcast interval по умолчанию.

Интервал обновления рассчитывается исходя из data rate выбранной конфигурации Channel.

### Smart Broadcast Minimum Distance {#smart-broadcast-minimum-distance}

По умолчанию `0` — это 100 м

Минимальная пройденная дистанция (с момента последней отправки, в метрах) перед отправкой позиции в mesh при включённом smart broadcast.

### Smart Broadcast Minimum Interval {#smart-broadcast-minimum-interval}

По умолчанию `0` — это 30 секунд

Минимальное время (с момента последней отправки, в секундах) перед отправкой позиции в mesh при включённом smart broadcast.

### Broadcast Interval {#broadcast-interval}

По умолчанию `0` — это 15 минут

Если smart broadcast выключен — отправлять позицию с таким интервалом.

Пакеты позиции отправляются каждый broadcast interval — либо с текущими координатами, либо пустые, если GPS‑фикса нет.

### Position Flags {#position-flags}

Определяет, какие поля отправляются в сообщениях POSITION. Значения хранятся как битовое поле булевых опций (побитовое OR PositionFlags).

|     Значение      |                                 Описание                                 |
| :---------------: | :------------------------------------------------------------------------: |
|       UNSET       |                         Требуется для компиляции                          |
|     ALTITUDE      |                   Включать высоту (если доступна)                         |
|   ALTITUDE_MSL    |                 Высота указана относительно MSL                           |
| GEOIDAL_SEPARATION|                       Включать геоидальное разделение                     |
|        DOP        |       Включать DOP; по умолчанию используется PDOP, см. ниже              |
|       HVDOP       | Если установлен POS_DOP, отправлять отдельные HDOP/VDOP вместо PDOP       |
|     SATINVIEW     |              Включать число спутников в зоне видимости                    |
|      SEQ_NO       |     Включать сквозной номер, увеличивающийся на каждый пакет              |
|     TIMESTAMP     |       Включать метку времени позиции (из решения GPS)                     |
|      HEADING      |               Включать курс (из решения GPS)                              |
|       SPEED       |              Включать скорость (из решения GPS)                           |

### GPIO RX/TX/EN для GPS‑модуля {#gpio-rx-tx-en-for-gps-module}

Если в устройстве нет фиксированного GPS‑чипа, можно задать GPIO‑пины для RX, TX и EN GPS‑модуля.

## Доступность клиентов для настроек Position {#position-config-client-availability}

<Tabs
  groupId="settings"
  defaultValue="apple"
  values={[
    {
      label: (
        <>
          <Icon icon="mdi:android" height="1.5rem" style={{ marginRight: "0.25rem" }} /> Android
        </>
      ),
      value: "android",
    },
    {
      label: (
        <>
          <Icon icon="mdi:apple" height="1.5rem" style={{ marginRight: "0.25rem" }} /> Apple
        </>
      ),
      value: "apple",
    },
    {
      label: (
        <>
          <Icon icon="mdi:terminal" height="1.5rem" style={{ marginRight: "0.25rem" }} /> CLI
        </>
      ),
      value: "cli",
    },
    {
      label: (
        <>
          <Icon icon="mdi:internet" height="1.5rem" style={{ marginRight: "0.25rem" }} /> Web
        </>
      ),
      value: "web",
    },
  ]}>
<TabItem value="android">

#### Android {#android}

:::note заметка

Настройки местоположения доступны на Android.

1. Откройте приложение Meshtastic
2. Перейдите: **Vertical Ellipsis (3 точки справа вверху) > Radio Configuration > Position**

:::

</TabItem>
<TabItem value="apple">

#### Apple {#apple}

:::note заметка
Все параметры Position доступны на iOS, iPadOS и macOS: Settings > Device Configuration > Position.
:::

</TabItem>
<TabItem value="cli">

#### CLI {#cli}

:::note заметка

Все команды Position доступны в python CLI. Примеры ниже:

:::

|                  Параметр                   |                                                             Допустимые значения                                                             |      Значение по умолчанию       |
| :-----------------------------------------: | :------------------------------------------------------------------------------------------------------------------------------------------: | :-------------------------------: |
|             position.gps_mode               |                                                   `ENABLED`, `DISABLED`, `NOT_PRESENT`                                                       |    `ENABLED` или `NOT_PRESENT`    |
|        position.gps_update_interval         |                                                            `integer` (seconds)                                                               |   По умолчанию `0` = 2 минуты     |
|           position.fixed_position           |                                                              `true`, `false`                                                                 |            `false`                |
| position.position_broadcast_smart_enabled   |                                                              `true`, `false`                                                                 |             `true`                |
| position.broadcast_smart_minimum_distance   |                                                            `integer` (meters)                                                                | По умолчанию `0` = 100 м          |
| position.broadcast_smart_minimum_interval_secs |                                                         `integer` (seconds)                                                                | По умолчанию `0` = 15 минут       |
|      position.position_broadcast_secs       |                                                            `integer` (seconds)                                                               | По умолчанию `0` = 15 минут       |
|                position.flags               | `UNSET`, `ALTITUDE`, `ALTITUDE_MSL`, `GEOIDAL_SEPARATION`, `DOP`, `HVDOP`, `PDOP`, `SATINVIEW`, `SEQ_NO`, `TIMESTAMP`, `HEADING`, `SPEED`    |             `UNSET`               |
|                position.rx_gpio             |                                                             `integer` (0-39)                                                                 |             `UNSET`               |
|                position.tx_gpio             |                                                             `integer` (0-34)                                                                 |             `UNSET`               |

:::tip совет

Так как устройство делает перезагрузку после каждой команды из CLI, при настройке нескольких значений лучше объединять команды в одну строку. Особенно важно для параметров Position — чтобы они применялись одновременно и не перезаписывались следующими командами.

```shell title="Пример:"
meshtastic --set position.fixed_position true --setlat 37.8651 --setlon -119.5383
```

:::

```shell title="Задать интервал обновления GPS (0 по умолчанию = 2 минуты)"
meshtastic --set position.gps_update_interval 0
meshtastic --set position.gps_update_interval 45
```

```shell title="Включить Fixed Position — текущие координаты"
meshtastic --set position.fixed_position true
```

:::note заметка
Устройство продолжит получать координаты по `gps_update_interval`, но будет использовать последние сохранённые координаты как фиксированную точку.
:::

```shell title="Задать и включить Fixed Position — пользовательские координаты"
meshtastic --setlat 37.8651 --setlon -119.5383
```

```shell title="Снять и отключить Fixed Position"
meshtastic --remove-position
```

```shell title="Включить/выключить smart broadcast позиции (по умолчанию включено)"
meshtastic --set position.position_broadcast_smart_enabled true
meshtastic --set position.position_broadcast_smart_enabled false
```

```shell title="Задать интервал position broadcast (0 по умолчанию = 15 минут)"
meshtastic --set position.broadcast_secs 0
meshtastic --set position.broadcast_secs 60
```

:::note заметка
Изменения могут стать заметны не сразу. GPS‑координаты обновляются по `gps_update_interval`, а mesh уведомляется о новой позиции согласно `position_broadcast_secs`.
:::

```shell title="Установить / сбросить Position Flags"
meshtastic --pos-fields ALTITUDE ALTITUDE_MSL
meshtastic --pos-fields UNSET
```

</TabItem>
<TabItem value="web">

#### Web {#web}

:::note заметка
Все Настройки местоположения доступны в Web UI.
:::

</TabItem>
</Tabs>
