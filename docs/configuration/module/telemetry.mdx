---
id: telemetry
title: Настройка модуля Телеметрия
sidebar_label: Телеметрия
description: Этот модуль позволяет передавать метрики устройства, окружения, здоровья и качества воздуха с вашего устройства Meshtastic.
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import { Icon } from "@iconify/react";
import ReactPlayer from "react-player";

Модуль Телеметрия передает по Mesh четыре типа данных: метрики устройства (уровень батареи, напряжение, загрузка канала и airtime) с вашего Meshtastic-устройства, метрики окружения, метрики качества воздуха и метрики здоровья (пульс, сатурация, температура тела).

Поддерживаемые датчики на I2C определяются при старте автоматически. Чтобы собирать показания и отправлять их по Mesh, включите модули Телеметрия: Environment, Air Quality и Health.

<div style={{ maxWidth: "800px", margin: "auto" }}>
  <ReactPlayer
    url="https://youtu.be/6jj1s-fsPlc"
    controls
    width="100%"
    height="400px"
  />
</div>

### Поддерживаемые типы датчиков {#currently-supported-sensor-types}

|    Sensor    | Адрес I<sup>2</sup>C |                                   Параметры                                   |
| :----------: | :-------------------: | :----------------------------------------------------------------------------: |
| AHT10, AHT20 |          0x38         |                          Температура и влажность                               |
|    BMP085    |       0x76, 0x77      |                   Температура и барометрическое давление                       |
|    BMP180    |       0x76, 0x77      |                   Температура и барометрическое давление                       |
|    BMP280    |       0x76, 0x77      |                   Температура и барометрическое давление                       |
|    BME280    |       0x76, 0x77      |            Температура, барометрическое давление и влажность                   |
|    BMP388    |       0x76, 0x77      |                       Барометрическое давление, температура                    |
|    BMP390    |       0x76, 0x77      |                       Барометрическое давление, температура                    |
|    BME68x    |       0x76, 0x77      |      Температура, барометрическое давление, влажность и сопротивление газа     |
|    DPS310    |       0x76, 0x77      |                       Барометрическое давление, температура                    |
|   MCP9808    |          0x18         |                                   Температура                                  |
|    INA219    |    0x40, 0x41, 0x43   |                               Ток и напряжение                                 |
|    INA226    |    0x40, 0x41, 0x43   |                               Ток и напряжение                                 |
|    INA260    |    0x40, 0x41, 0x43   |                               Ток и напряжение                                 |
|   INA3221    |          0x42         |                        3‑канальный ток и напряжение                            |
|    LPS22     |       0x5D, 0x5C      |                           Барометрическое давление                             |
|    SHTC3     |          0x70         |                          Температура и влажность                               |
|    SHT31     |       0x44, 0x45      |                          Температура и влажность                               |
|    SHT4X     |       0x44, 0x45      |                          Температура и влажность                               |
|   OPT3001    |       0x44, 0x45      |                                 Освещенность                                   |
|   VEML7700   |          0x10         |                                 Освещенность                                   |
|   TSL2591    |          0x29         |                                 Освещенность                                   |
|   LTR390UV   |          0x53         |                           Интенсивность УФ‑света                               |
|   RCWL9620   |          0x57         |                           Ультразвуковой дальномер                             |
|   PMSA003I   |          0x12         |           Концентрация по размерам и количество частиц по размерам             |
| DFROBOT_LARK |          0x42         | Температура, барометрическое давление, влажность, направление и скорость ветра |
| DFROBOT_RAIN |          0x1d         |                     Счетчик осадков (tipping bucket)                           |
|   RadSens    |          0x66         |                             Радиационный дозиметр                              |
|   MAX30102   |          0x57         |                 Пульс, сатурация и температура тела                            |
|   MLX90614   |          0x5A         |                             Температура тела                                   |
|   MLX90632   |          0x3A         |                             Температура тела                                   |
|   NAU7802    |          0x2A         |               24‑бит АЦП (дифф.) для моста Уитстона                            |

## Параметры модуля {#module-config-values}

### Включить телеметрию окружения {#environment-telemetry-enabled}

Включить Environment Телеметрия (Датчики).

### Интервал обновления метрик окружения {#environment-metrics-update-interval}

Как часто отправлять метрики окружения (Sensors) по Mesh.

По умолчанию: `1800` сек (30 минут).

### Интервал обновления метрик устройства {#device-metrics-update-interval}

Как часто отправлять метрики устройства по Mesh.

По умолчанию: `1800` сек (30 минут).

В подключенное клиентское приложение метрики устройства отправляются раз в минуту, независимо от этой настройки.

### Показ на экране окружения {#environment-screen-enabled}

Показывать телеметрию окружения на дисплее устройства.

По умолчанию: `false`.

### Показывать в °F {#display-fahrenheit}

Датчик всегда читается в °C, но можно показывать в °F (только на дисплее).

По умолчанию: `false`.

### Включить Air Quality {#air-quality-enabled}

Включить/выключить отправку метрик качества воздуха с поддерживаемого подключенного датчика по Mesh.

По умолчанию: `false`.

### Интервал Air Quality {#air-quality-interval}

Интервал (в секундах) отправки метрик качества воздуха с поддерживаемого подключенного датчика по Mesh.

По умолчанию: `1800` сек (30 минут).

### Включить метрики питания {#power-metrics-enabled}

Включить/выключить отправку телеметрии питания от поддерживаемого датчика напряжения/тока. Для мониторинга напряжения батареи включать не нужно.

По умолчанию: `false`.

### Интервал метрик питания {#power-metrics-interval}

Интервал (в секундах) отправки метрик питания от поддерживаемого подключенного датчика по Mesh.

### Включить Health Telemetry {#health-telemetry-enabled}

Включить/выключить отправку данных о состоянии здоровья с поддерживаемого подключенного датчика по Mesh.

По умолчанию: `false`.

### Интервал Health Telemetry {#health-telemetry-interval}

Интервал (в секундах) отправки данных о состоянии здоровья с поддерживаемого подключенного датчика по Mesh.

По умолчанию: `1800` сек (30 минут).

## Доступность настроек Telemetry в клиентах {#telemetry-config-client-availability}

<Tabs
  groupId="settings"
  defaultValue="apple"
  values={[
    {
      label: (
        <>
          <Icon icon="mdi:android" height="1.5rem" style={{ marginRight: "0.25rem" }} /> Android
        </>
      ),
      value: "android",
    },
    {
      label: (
        <>
          <Icon icon="mdi:apple" height="1.5rem" style={{ marginRight: "0.25rem" }} /> Apple
        </>
      ),
      value: "apple",
    },
    {
      label: (
        <>
          <Icon icon="mdi:terminal" height="1.5rem" style={{ marginRight: "0.25rem" }} /> CLI
        </>
      ),
      value: "cli",
    },
    {
      label: (
        <>
          <Icon icon="mdi:internet" height="1.5rem" style={{ marginRight: "0.25rem" }} /> Web
        </>
      ),
      value: "web",
    },
  ]}>
<TabItem value="android">

#### Android

:::note заметка

Настройки Телеметрия доступны в Android.

1. Откройте Meshtastic App
2. Перейдите: **Вертикальное многоточие (3 dots top right) > Конфигурация радио > Телеметрия**

:::

</TabItem>
<TabItem value="apple">

#### Apple

:::note заметка
Все настройки модуля Телеметрия доступны на iOS, iPadOS и macOS: Настройки > Конфигурация модуля > Телеметрия (Датчики).

:::

</TabItem>
<TabItem value="cli">

#### CLI

:::note заметка

Все настройки модуля Телеметрия доступны в python CLI. Примеры команд ниже:

:::

## Настройки {#settings}

|                 Параметр                  | Допустимые значения |                    По умолчанию                     |
| :---------------------------------------: | :-----------------: | :-------------------------------------------------: |
|     telemetry.device_update_interval      | `integer` (seconds) | Значение `0` — это 30 минут (`1800` секунд).        |
| telemetry.environment_display_fahrenheit  |   `true`, `false`   |                      `false`                        |
| telemetry.environment_measurement_enabled |   `true`, `false`   |                      `false`                        |
|   telemetry.environment_screen_enabled    |   `true`, `false`   |                      `false`                        |
|   telemetry.environment_update_interval   | `integer` (seconds) | Значение `0` — это 30 минут (`1800` секунд).        |
|       telemetry.air_quality_enabled       |   `true`, `false`   |                      `false`                        |
|      telemetry.air_quality_interval       | `integer` (seconds) | Значение `0` — это 30 минут (`1800` секунд).        |
|    telemetry.power_measurement_enabled    |   `true`, `false`   |                      `false`                        |
|      telemetry.power_update_interval      | `integer` (seconds) | Значение `0` — это 30 минут (`1800` секунд).        |
|   telemetry.health_measurement_enabled    |   `true`, `false`   |                      `false`                        |
|     telemetry.health_update_interval      | `integer` (seconds) | Значение `0` — это 30 минут (`1800` секунд).        |
|      telemetry.health_screen_enabled      |   `true`, `false`   |                      `false`                        |

:::tip совет

Так как устройство перезагружается после каждой команды из CLI, при настройке нескольких значений в одном разделе лучше объединять их в одну команду.

```shell title="Пример:"
meshtastic --set telemetry.device_update_interval 0 --set telemetry.environment_update_interval 0
```

:::

```shell title="Set module update intervals (Default of 0 is 5 Minutes)"
meshtastic --set telemetry.device_update_interval 0
// Метрики устройства: две минуты
meshtastic --set telemetry.device_update_interval 0
// Метрики окружения: две минуты
meshtastic --set telemetry.environment_update_interval 120
```

```shell title="Enable/Disable Environment Module"
meshtastic --set telemetry.environment_measurement_enabled true
meshtastic --set telemetry.environment_measurement_enabled false
```

```shell title="Enable/Disable on device screen"
meshtastic --set telemetry.environment_screen_enabled true
meshtastic --set telemetry.environment_screen_enabled false
```

```shell title="Enable / Disable Display Fahrenheit"
meshtastic --set telemetry.environment_display_fahrenheit true
meshtastic --set telemetry.environment_display_fahrenheit false
```

</TabItem>
<TabItem value="web">

#### Web

:::note заметка

Все настройки модуля Телеметрия доступны в Web UI.

:::

</TabItem>
</Tabs>

## Примеры {#examples}

### RAK 4631 с датчиком BME680 {#rak-4631-with-bme680-environment-sensor}

Подключение RAK 4631 с датчиком окружения

[<img src="RAK4631_with_EnvSensor" src="/img/hardware/rak/RAK4631_with_EnvSensor.webp" style={{zoom:'25%'}} />](/img/hardware/rak/RAK4631_with_EnvSensor.webp)

Что нужно:

- RAK4631
- Датчик окружения

Шаги:

- настройте устройство:

```shell
meshtastic --set telemetry.environment_measurement_enabled true --set telemetry.environment_screen_enabled true --set telemetry.environment_display_fahrenheit true
```

:::tip совет

Значения выше — лишь пример, меняйте под свои задачи. Рекомендуется объединять несколько команд, как в примере — так будет меньше перезагрузок.

:::

- После отправки команды устройство перезагрузится.
- После следующей загрузки устройство должно показать "Телеметрия" и, возможно, данные датчика.
- Если эффекта нет — выполните:

```shell
meshtastic --noproto
```

И посмотрите Serial-логи для диагностики Телеметрии.

## Поддержка дополнительных датчиков {#supporting-additional-sensors}

### Метрики окружения {#environment-metrics}

В модуле телеметрии метрики окружения ограничены — они хранятся в памяти устройства. Поддержку датчиков, которые выдают одно или несколько полей ниже, можно добавить в основную прошивку, если есть GPL‑библиотека разумного размера для их поддержки.

- Температура
- Относительная влажность
- Барометрическое давление
- Сопротивление газа (AQI)
- Напряжение
- Ток

### Поддержка других типов датчиков {#supporting-other-sensor-types}

Для других интересных датчиков и сценариев нужен новый portnum для универсальных пакетов телеметрии и второй MCU для работы с датчиком и обработки данных для отправки по Mesh. Эти данные не сохраняются в nodedb на устройстве.