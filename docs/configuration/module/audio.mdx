---
id: audio
title: Настройка аудиомодуля
sidebar_label: Аудио
description: Подробности настройки аудиомодуля вашего устройства Meshtastic
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import { Icon } from "@iconify/react";

Варианты настроек аудио: Codec2 Enabled, PTT GPIO, Audio Bitrate/Codec Mode, I2S Word Select, I2S Data IN, I2S Data OUT и I2S Clock. Настройка аудиомодуля отправляется как admin message с protobuf `ConfigModule.Audio`.

С этим **экспериментальным** модулем можно добавить цифровой I2S‑микрофон и динамик к любому устройству ESP32 с радио SX128x, работающему в ISM‑диапазоне 2.4 ГГц. Диапазоны Sub‑1GHz слишком узкие для непрерывной передачи аудио по Mesh, даже в режимах `Short` и `Fast`. На данный момент поддерживаются только платы LilyGo TLora 2.1-1.8 и TLora T3S3. Модуль рассчитан на каналы с полосой 2 кбит/с и выше.

Требуется доп. железо:

- Max98357 — I2S, 3 Вт усилитель класса D
- MSM261S4030H0 — I2S MEMS малошумящий моно микрофон

## Значения настроек аудиомодуля {#audio-module-config-values}

### Codec2 Enabled {#codec2-enabled}

Включает аудиомодуль.

### PTT GPIO {#ptt-gpio}

GPIO для кнопки PTT. По умолчанию GPIO 39 на ESP32.

### Audio Bitrate/Codec Mode {#audio-bitrate-codec-mode}

Битрейт для аудио. По умолчанию `CODEC2_700B`. Доступные варианты:

- CODEC2_DEFAULT
- CODEC2_3200
- CODEC2_2400
- CODEC2_1600
- CODEC2_1400
- CODEC2_1300
- CODEC2_1200
- CODEC2_700B
- CODEC2_700

### I2S Word Select {#i2s-word-select}

GPIO для сигнала WS интерфейса I2S.

### I2S Data IN {#i2s-data-in}

GPIO для сигнала SD интерфейса I2S.

### I2S Data OUT {#i2s-data-out}

GPIO для сигнала DIN интерфейса I2S.

### I2S Clock {#i2s-clock}

GPIO для сигнала SCK интерфейса I2S.

:::note Что это?
Эти пины составляют цифровой аудиоинтерфейс I2S. Meshtastic использует его в моно‑режиме. ПО использует логический стереоканал 'LEFT' для микрофона и логический 'RIGHT' для динамика, поэтому настраивайте платы‑переходники соответственно. Аудио работает в Half‑Duplex, поэтому часть пинов можно переиспользовать для двунаправленной схемы. Назначения пинов по умолчанию **нет**, их нужно задать обязательно.
:::

## Доступность настроек аудиомодуля в клиентах {#audio-module-config-client-availability}

<Tabs
  groupId="settings"
  defaultValue="apple"
  values={[
    {
      label: (
        <>
          <Icon icon="mdi:android" height="1.5rem" style={{ marginRight: "0.25rem" }} /> Android
        </>
      ),
      value: "android",
    },
    {
      label: (
        <>
          <Icon icon="mdi:apple" height="1.5rem" style={{ marginRight: "0.25rem" }} /> Apple
        </>
      ),
      value: "apple",
    },
    {
      label: (
        <>
          <Icon icon="mdi:terminal" height="1.5rem" style={{ marginRight: "0.25rem" }} /> CLI
        </>
      ),
      value: "cli",
    },
    {
      label: (
        <>
          <Icon icon="mdi:internet" height="1.5rem" style={{ marginRight: "0.25rem" }} /> Web
        </>
      ),
      value: "web",
    },
  ]}>
<TabItem value="android">

#### Android {#android}

:::note заметка

Настройки аудио доступны на Android.

1. Откройте приложение Meshtastic
2. Перейдите: **Вертикальное многоточие (3 точки справа вверху) > Radio Configuration > Audio**

:::

</TabItem>
<TabItem value="apple">

#### Apple {#apple}

:::note заметка
Настройка аудиомодуля недоступна на iOS, iPadOS и macOS.
:::

</TabItem>
<TabItem value="cli">

#### CLI {#cli}

:::note заметка

Все параметры аудиомодуля доступны в Python CLI. Примеры команд ниже:

:::

|       Параметр       |                                                        Допустимые значения                                                        |        По умолчанию         |
| :------------------: | :--------------------------------------------------------------------------------------------------------------------------------: | :-------------------------: |
| audio.codec2_enabled |                                                         `true`, `false`                                                            |          `false`            |
|    audio.ptt_pin     |                                                      Номер GPIO 1–39                                                               | По умолчанию `39` (не задано) |
|    audio.bitrate     | `CODEC2_DEFAULT` `CODEC2_3200` `CODEC2_2400` `CODEC2_1600` `CODEC2_1400` `CODEC2_1300` `CODEC2_1200` `CODEC2_700B` `CODEC2_700` |      `CODEC2_DEFAULT`       |
|     audio.i2s_ws     |                                                      Номер GPIO 1–34                                                               |   нет значения по умолчанию |
|     audio.i2s_sd     |                                                      Номер GPIO 1–39                                                               |   нет значения по умолчанию |
|    audio.i2s_din     |                                                      Номер GPIO 1–34                                                               |   нет значения по умолчанию |
|    audio.i2s_sck     |                                                      Номер GPIO 1–34                                                               |   нет значения по умолчанию |

:::tip совет

Так как устройство перезагружается после каждой команды через CLI, при настройке нескольких значений в одном разделе лучше объединять команды в одну строку.

```shell title="Пример:"
meshtastic --set audio.codec2_enabled true --set audio.bitrate CODEC2_1400
```

:::

```shell title="Включить/выключить модуль"
meshtastic --set audio.codec2_enabled true
meshtastic --set audio.codec2_enabled false
```

```shell title="WS на GPIO 7"
meshtastic --set audio.i2s_ws 7
```

```shell title="DIN на GPIO 28"
meshtastic --set audio.i2s_din 28
```

```shell title="PTT на GPIO 37"
meshtastic --set audio.ptt_pin 37
```

```shell title="Выбрать битрейт Codec"
meshtastic --set audio.bitrate CODEC2_DEFAULT
meshtastic --set audio.bitrate CODEC2_1400
```

</TabItem>
<TabItem value="web">

#### Web {#web}

:::note заметка
Все настройки аудио доступны в Web UI.
:::

</TabItem>
</Tabs>

:::caution осторожно

Доступ к GPIO потенциально опасен: неверные параметры могут повредить или вывести из строя ваше железо. Перед началом убедитесь, что вы понимаете схему именно вашего устройства. Гарантии нет. Все действия — на свой страх и риск.

Этому модулю требуется внешний аудио‑аксессуар. Без него работать не будет.

:::