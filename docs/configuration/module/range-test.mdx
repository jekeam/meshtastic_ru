---
id: range-test
title: Настройка модуля теста дальности
sidebar_label: Тест дальности
description: Как настроить модуль теста дальности для отчётов, карт и т.д.
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

Этот модуль позволяет тестировать дальность связи между двумя узлами Meshtastic. Сообщения теста дальности видны только на клиентах узлов, где модуль включён.

- Передатчик: стационарный узел, отправляет последовательные пакеты (интервал «Sender message interval» 30–60 с);
- Приёмник: мобильный узел (обычно вы) с GPS на борту или в телефоне.

Узлы считаются в зоне приёма, пока принимаются последовательные пакеты.

Принимающий узел может сохранять сообщения вместе с GPS‑координатами места приёма в файл .csv. Этот .csv‑файл можно загрузить в [Google Earth](https://earth.google.com), [Google Maps - My Maps](https://mymaps.google.com) или другую программу, которая умеет работать с .csv. Это позволит визуализировать ваш Mesh. Убедитесь, что [position precision](https://meshtastic.org/docs/configuration/radio/channels/#position-precision) в канале по умолчанию установлена на high, иначе данные не будут соответствовать вашему реальному местоположению.

:::info информация

Не забудьте выключить модуль или остановить отправку, когда он не нужен. Это сильно занимает эфир, замедляет Mesh и засоряет Channel. Модуль автоматически выключается через 8 часов.

:::

Параметры модуля: Enabled, Sender и Save. Конфиг модуля отправляется админ‑сообщением с protobuf `ModuleConfig.RangeTestConfig`.

## Параметры модуля теста дальности {#range-test-module-config-values}

### Включение {#enabled}

Включает модуль теста дальности. И у передатчика, и у приёмника модуль должен быть включён. В приложениях Apple и Android для приёма сообщений теста дальности модуль тоже должен быть включён. Экран устройства может продолжать показывать пакеты теста дальности от старых версий прошивки, даже если модуль выключен.

### Интервал отправки {#sender-interval}

Задержка между отправкой последовательных тестовых пакетов. 0 — значение по умолчанию, отключает отправку.

### Рекомендованные настройки передатчика {#recommended-sender-settings}

| Настройка радио | `range_test.sender` |
| :-------------: | :-----------------: |
|    Long Slow    |         60          |
|    Long Fast    |         30          |
|     Medium      |         15          |
|   Short Fast    |         15          |

### Сохранять CSV {#save-csv-file}

:::info информация

Оставьте выключенным при работе с Android или Apple‑приложениями. Сохраняет прямо во flash‑память устройства (без смартфона), доступно только на устройствах на ESP32.

:::

Если включено, все принятые сообщения сохраняются во flash‑память устройства в файл `rangetest.csv`.

Чтобы получить этот файл, включите Wi‑Fi на устройстве и подключите его к своей сети. Затем откройте `meshtastic.local/rangetest.csv` (или your_device_ip/rangetest.csv) — файл скачается автоматически. Файл создаётся после получения первых сообщений.

Чтобы не забить память, запись прекращается, если на файловой системе осталось меньше 50 КБ.

## Доступность настроек модуля в клиентах {#range-test-module-config-client-availability}

<Tabs
groupId="settings"
defaultValue="android"
values={[
{label: 'Android', value: 'android'},
{label: 'Apple', value: 'apple'},
{label: 'CLI', value: 'cli'},
{label: 'Web', value: 'web'},
]}>
<TabItem value="android">

#### Android

:::info информация

Опции конфигурации Тест дальности доступны в Android.

1. Откройте приложение Meshtastic
2. Перейдите: **Вертикальное многоточие (3 точки сверху справа) > Конфигурация радио > Тест дальности**

:::

Android экспортирует файл rangetest.csv из пакетов в `Debug Log`. Чтобы очистить старую историю пакетов: `Debug Panel > Clear`

</TabItem>
<TabItem value="apple">

#### Apple

:::info информация
Все настройки модуля теста дальности доступны в iOS, iPadOS и macOS: Настройки > Конфигурация модуля > Тест дальности.
:::

В приложениях Apple можно скачать журнал позиций, который хранится на вашем iPhone/iPad/Mac. Откройте вкладку Nodes, выберите узел, затем выберите Position Log и нажмите Save. Для этого файл Range Test не обязан быть активен.

</TabItem>
<TabItem value="cli">

#### CLI

:::info информация

Настройки модуля Тест дальности доступны в Python CLI. Ниже примеры команд:

:::

|    Параметр     | Допустимые значения | По умолчанию |
| :-------------: | :-----------------: | :----------: |
| range_test.enabled |   `true`, `false`   |   `false`    |
|  range_test.save   |   `true`, `false`   |   `false`    |
| range_test.sender  | `integer` (Seconds) |     `0`      |

:::tip подсказка

Так как устройство перезагружается после каждой команды из CLI, при настройке нескольких значений в одном разделе лучше отправить их одной связанной командой.

```shell title="Пример:"
meshtastic --set range_test.enabled true --set range_test.save false
```

:::

```shell title="Включить / выключить тест дальности"
meshtastic --set range_test.enabled true
meshtastic --set range_test.enabled false
```

```shell title="Включить / выключить сохранение результатов"
meshtastic --set range_test.save true
meshtastic --set range_test.save false
```

```shell title="Включить отправку (каждые 60 секунд)"
meshtastic --set range_test.sender 60
```

```shell title="Отключить отправку"
meshtastic --set range_test.sender 0
```

</TabItem>
<TabItem value="web">

#### Web

:::info информация

Все настройки модуля теста дальности доступны в Web UI.

:::

</TabItem>
</Tabs>


## Примеры использования {#application-examples}

### Интеграция с Google Earth {#google-earth-integration}

Шаги:

1. [Скачайте](https://www.google.com/earth/versions/#download-pro) и откройте Google Earth
   1. File > Import
   2. Выберите CSV
   3. Выберите Delimited, Comma
   4. Убедитесь, что кнопка “This dataset does not contain latitude/longitude information, but street addresses” НЕ отмечена
   5. Выберите “rx lat” и “rx long” для полей широты/долготы
   6. Нажмите Finish
2. Когда появится предложение создать шаблон стиля, нажмите Yes.
   1. Установите поле name на столбец, который хотите показывать на карте (не критично — при клике по значку будет видно все данные)
   2. Выберите цвет, значок и т.д., затем OK.

Данные загрузятся на карту. Поставьте галочку рядом с вашим набором данных в боковой панели, чтобы отобразить его.

### My Maps {#my-maps}

Можно использовать [My Maps](http://mymaps.google.com). Он принимает CSV, а интерфейс проще.

Инструкции от Google — [здесь](https://support.google.com/mymaps/answer/3024836?co=GENIE.Platform%3DDesktop&hl=en#zippy=%2Cstep-prepare-your-info%2Cstep-import-info-into-the-map).

Можно стилизовать дальности по значениям, например, делать метки темнее при большем SNR или RSSI (если он будет добавлен).

### OpenStreetMap — uMap {#openstreetmap-umap}

В качестве open source‑решения можно использовать [uMap](https://umap.openstreetmap.de/en/) — сервис на базе OpenStreetMap.

Зайдите на [uMap](https://umap.openstreetmap.de/en/) на удобном вам языке.
1. Нажмите "Create a map"
2. Нажмите на иконку "Import data" или CTRL + I.
3. Выберите ваш rangetest.csv и нажмите "Import". Формат данных будет распознан, и точки загрузятся на карту.